<%= render "shared/content_title", title_var: "Post Search" %>

<%= form_tag(search_posts_path, :method => "get", class: "well form-inline") do %>
	<div class="control-group">
		<%= label_tag(:uname, "Search for posts from a user:") %>
		<%= text_field_tag(:uname, params[:uname] || "<enter poster name here>") %>
	</div>

	<div class="control-group">
		<%= label_tag(:with_comments, "With at least one comment") %>
		<%= check_box_tag(:with_comments, "1", @with_comments_val == "1") %>
	</div>

	<div class="control-group">
		<%= label_tag(:with_comment_text, "Containing this in the comment") %>
		<%= text_field_tag(:with_comment_text, params[:with_comment_text] || "") %>
	</div>

	<div class="control-group">
		<%= label_tag(:sorting, "Sort results by") %>
		<%= select_tag(:sorting, options_for_select(@sort_options_array, @sorting_val)) %>
	</div>

	<br>
	<%= submit_tag("Search") %>
<% end %>

<!-- we may already have search results, so display them here -->
<hr/>

<% if (params[:uname] && (params[:uname].size > 0)) || (params[:with_comment_text] && (params[:with_comment_text].size > 0)) %>
	<!-- this is a hint that a search has occurred -->
	<!-- now we have to figure out whether any results matched our query -->
	<% if @search_results.size == 0 %>
		<!-- no results match, so give feedback that we DID do a search but nothing was found -->
		<h4>No posts match your search</h4>
	<% else %>
		<h4><%= "#{@search_results.size} " + "post".pluralize(@search_results.size) + " found." %></h4>

		<%= render "posts/post_list", post_list: @search_results %>
	<% end %>

<% end %>
